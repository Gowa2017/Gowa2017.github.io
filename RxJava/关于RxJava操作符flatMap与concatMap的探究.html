<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>关于RxJava操作符flatMap与concatMap的探究 | 退思园</title><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.3"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.3"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css?v=2.0.3"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js?v=2.0.3"></script><script src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=2.0.3"></script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">关于RxJava操作符flatMap与concatMap的探究</h1><a id="logo" href="/.">退思园</a><p class="description">烦恼一般都是想太多了。</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/workflow"><i class="fa fa-rss"> workflow</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="搜索"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">关于RxJava操作符flatMap与concatMap的探究</h1><div class="post-meta"><a href="/RxJava/关于RxJava操作符flatMap与concatMap的探究.html#comments" class="comment-count"><i data-disqus-identifier="RxJava/关于RxJava操作符flatMap与concatMap的探究.html" class="disqus-comment-count"></i>留言</a><p><span class="date">Aug 01, 2019</span><span><a href="/categories/RxJava/" class="category">RxJava</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><p>迷惑的地方在于当 flatMap 和 concatMap 在运作的时候，在配合线程切换的话，其细节到底是怎么样的呢？<br><a id="more"></a></p>
<h1 id="FlatMap"><a href="#FlatMap" class="headerlink" title="FlatMap"></a>FlatMap</h1><p>根据 Reactivex.io 网站上的定义：</p>
<blockquote>
<p>The FlatMap operator transforms an Observable by applying a function that you specify to each item emitted by the source Observable, where that function returns an Observable that itself emits items. FlatMap then merges the emissions of these resulting Observables, emitting these merged results as its own sequence.</p>
<p>This method is useful, for example, when you have an Observable that emits a series of items that themselves have Observable members or are in other ways transformable into Observables, so that you can create a new Observable that emits the complete collection of items emitted by the sub-Observables of these items.</p>
<p><strong>Note</strong> that FlatMap merges the emissions of these Observables, so that they may interleave.</p>
</blockquote>
<p>这些说的是：</p>
<ol>
<li>我们使用一个函数来将 Observable 发射的每个元素都变换为一个 Observable。这个函数，我们称之为 <em>mapper</em></li>
<li>然后 FlatMap 将所有变换后的 Observable 发射的元素进行 merge(合并)，最终，得到一个发射所有这些合并后元素的 Observable。</li>
<li>merge(合并)后的元素，其顺序是不一定的。</li>
</ol>
<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p>首先，我们知道，<a href="/RxJava/关于RxJava操作符链式调用的理解.html" title="RxJava 的运作其实分成三个阶段">RxJava 的运作其实分成三个阶段</a>：</p>
<ul>
<li>装配（Assembly Time）</li>
<li>订阅（Subscription Time）</li>
<li>运行（Runtime）</li>
</ul>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Observable.just(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>)</span><br><span class="line">        .flatMap(<span class="keyword">new</span> Function&lt;String, ObservableSource&lt;String&gt;&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> ObservableSource&lt;String&gt; <span class="title">apply</span><span class="params">(String it)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> Observable.create(emitter -&gt; &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">                        emitter.onNext(String.format(<span class="string">"%s-%d"</span>, it, i));</span><br><span class="line">                    &#125;</span><br><span class="line">                    ;</span><br><span class="line">                    emitter.onComplete();</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .subscribe(System.out::println);</span><br></pre></td></tr></table></figure>
<h3 id="Assembly"><a href="#Assembly" class="headerlink" title="Assembly"></a>Assembly</h3><p><code>Observable.just(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;)</code> 会返回一个 ObservableFromArray，在此我称其为 <em>source</em>。</p>
<p>当我们调用 <code>source.flatMap()</code>的时候，其实是在装配阶段，这个时候，其结果，会返回一个 ObservableFlatMap，为了称呼，我们称之为 <em>flatObservable</em>，此 ObservableFlatMap 的上流（upstream） 就是 <em>source</em>：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">RxJavaPlugins.onAssembly(<span class="keyword">new</span> ObservableFlatMap&lt;T, R&gt;(<span class="keyword">this</span>, mapper, delayErrors, maxConcurrency, bufferSize));</span><br></pre></td></tr></table></figure>
<p>好了，这个时候， <em>source</em> 与 <em>flatObservable</em> 之间的联系，也就是 <em>flatObservable</em> 持有 <em>source</em> 而已。</p>
<h3 id="Runtime"><a href="#Runtime" class="headerlink" title="Runtime"></a>Runtime</h3><p>当我们对 <em>flatObservable</em> 进行订阅的时候，实际上，我们是对其指定了一个 Observer。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// ObservableFlatMap</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribeActual</span><span class="params">(Observer&lt;? <span class="keyword">super</span> U&gt; t)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ObservableScalarXMap.tryScalarXMapSubscribe(source, t, mapper)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    source.subscribe(<span class="keyword">new</span> MergeObserver&lt;T, U&gt;(t, mapper, delayErrors, maxConcurrency, bufferSize));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>是不是很惊喜，<em>flatObservable</em> 利用一个 <em>MergeObserver</em> 又订阅了 <em>source</em>。</p>
<p>我们来看看， 我们的 <em>source</em> ObservableFromArray 这个时候干了什么：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ObservableFromArray</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribeActual</span><span class="params">(Observer&lt;? <span class="keyword">super</span> T&gt; observer)</span> </span>&#123;</span><br><span class="line">        FromArrayDisposable&lt;T&gt; d = <span class="keyword">new</span> FromArrayDisposable&lt;T&gt;(observer, array);</span><br><span class="line"></span><br><span class="line">        observer.onSubscribe(d);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (d.fusionMode) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        d.run();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">FromArrayDisposable(Observer&lt;? <span class="keyword">super</span> T&gt; actual, T[] array) &#123;</span><br><span class="line">    <span class="keyword">this</span>.downstream = actual;</span><br><span class="line">    <span class="keyword">this</span>.array = array;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    T[] a = array;</span><br><span class="line">    <span class="keyword">int</span> n = a.length;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n &amp;&amp; !isDisposed(); i++) &#123;</span><br><span class="line">        T value = a[i];</span><br><span class="line">        <span class="keyword">if</span> (value == <span class="keyword">null</span>) &#123;</span><br><span class="line">            downstream.onError(<span class="keyword">new</span> NullPointerException(<span class="string">"The "</span> + i + <span class="string">"th element is null"</span>));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        downstream.onNext(value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!isDisposed()) &#123;</span><br><span class="line">        downstream.onComplete();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>很简单，ObservableFromArray 建立了一个 FromArrayDisposable，其利用了 for 循环，给 downstream 传递数据（这里是 MergeObserver ）传递数据。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//MergeObserver</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(T t)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// safeguard against misbehaving sources</span></span><br><span class="line">            <span class="keyword">if</span> (done) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ObservableSource&lt;? extends U&gt; p;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                p = ObjectHelper.requireNonNull(mapper.apply(t), <span class="string">"The mapper returned a null ObservableSource"</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">                Exceptions.throwIfFatal(e);</span><br><span class="line">                upstream.dispose();</span><br><span class="line">                onError(e);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (maxConcurrency != Integer.MAX_VALUE) &#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (wip == maxConcurrency) &#123;</span><br><span class="line">                        sources.offer(p);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    wip++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            subscribeInner(p);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>MergeObserver 首先调用我们提供的 mapper 函数来获得一个 Observable。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// MergeObserver</span></span><br><span class="line">        <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">subscribeInner</span><span class="params">(ObservableSource&lt;? extends U&gt; p)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">                <span class="keyword">if</span> (p <span class="keyword">instanceof</span> Callable) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (tryEmitScalar(((Callable&lt;? extends U&gt;)p)) &amp;&amp; maxConcurrency != Integer.MAX_VALUE) &#123;</span><br><span class="line">                        <span class="keyword">boolean</span> empty = <span class="keyword">false</span>;</span><br><span class="line">                        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">                            p = sources.poll();</span><br><span class="line">                            <span class="keyword">if</span> (p == <span class="keyword">null</span>) &#123;</span><br><span class="line">                                wip--;</span><br><span class="line">                                empty = <span class="keyword">true</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (empty) &#123;</span><br><span class="line">                            drain();</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    InnerObserver&lt;T, U&gt; inner = <span class="keyword">new</span> InnerObserver&lt;T, U&gt;(<span class="keyword">this</span>, uniqueId++);</span><br><span class="line">                    <span class="keyword">if</span> (addInner(inner)) &#123;</span><br><span class="line">                        p.subscribe(inner);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>接着，用一个 InnerObserver 来订阅了我们 mapper 返回的 Observable。这里，如果是 Callable 来的 Observer ,就直接发射数据了。InnerObserver 有一个 parent 参数，这里是 MergeObserver。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//InnerObserver</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(Disposable d)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (DisposableHelper.setOnce(<span class="keyword">this</span>, d)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (d <span class="keyword">instanceof</span> QueueDisposable) &#123;</span><br><span class="line">                    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">                    QueueDisposable&lt;U&gt; qd = (QueueDisposable&lt;U&gt;) d;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">int</span> m = qd.requestFusion(QueueDisposable.ANY | QueueDisposable.BOUNDARY);</span><br><span class="line">                    <span class="keyword">if</span> (m == QueueDisposable.SYNC) &#123;</span><br><span class="line">                        fusionMode = m;</span><br><span class="line">                        queue = qd;</span><br><span class="line">                        done = <span class="keyword">true</span>;</span><br><span class="line">                        parent.drain();</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (m == QueueDisposable.ASYNC) &#123;</span><br><span class="line">                        fusionMode = m;</span><br><span class="line">                        queue = qd;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(U t)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (fusionMode == QueueDisposable.NONE) &#123;</span><br><span class="line">                parent.tryEmit(t, <span class="keyword">this</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                parent.drain();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>当我们 mapper 向 InnerObserver 发射数据的时候，其直接将数据发射给了 MergeObserver。</p>
<p>这里说明一下，如果 InnerObserver 订阅的是一个 QueueDisposable 的话，那么其就会协商一下，发送模式，如果是同步发射，就会要求 MergeObserver 将所有 mapper 返回的 Observable 数据全部发射到 最下游再继续。</p>
<p>当我们的 mapper 返回的 Observable 发射模式是 QueueDisposable.NONE 时，MergeObserver 采用的是 tryEmit 的形式来发射数据：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tryEmit</span><span class="params">(U value, InnerObserver&lt;T, U&gt; inner)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (get() == <span class="number">0</span> &amp;&amp; compareAndSet(<span class="number">0</span>, <span class="number">1</span>)) &#123;</span><br><span class="line">        downstream.onNext(value);</span><br><span class="line">        <span class="keyword">if</span> (decrementAndGet() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        SimpleQueue&lt;U&gt; q = inner.queue;</span><br><span class="line">        <span class="keyword">if</span> (q == <span class="keyword">null</span>) &#123;</span><br><span class="line">            q = <span class="keyword">new</span> SpscLinkedArrayQueue&lt;U&gt;(bufferSize);</span><br><span class="line">            inner.queue = q;</span><br><span class="line">        &#125;</span><br><span class="line">        q.offer(value);</span><br><span class="line">        <span class="keyword">if</span> (getAndIncrement() != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    drainLoop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果数据无法立即发射，那么就把他放在队列中，在 for 循环内进行遍历发射。</p>
<p>看起来好像不会出乱序的情况？例子中的执行确实也没有出现乱序这是为什么？ 这是因为我们是在同一个线程内进行操作的，同时我们的数据也比较特殊。</p>
<p>可以从这里来看，对于每一个 mapper 返回的 Observable，我们都用 InnerObserver 来进行了订阅，但是其何时发射数据，这个是不一定的。所以说，在 InnerObserver 的 onNext 方法中，随后调用 MergeObserver.tryEmit(value, inner) 的方法时，会有需要发射的值，放到 inner 的队列中，然后再进行发射。</p>
<p>因此这个顺序是不一定的。</p>
<h1 id="ConcatMap"><a href="#ConcatMap" class="headerlink" title="ConcatMap"></a>ConcatMap</h1><p>ConcatMap 的实现其实和 flatMap 有相似的地方。不过其多做了一点事情：</p>
<ol>
<li>用 SourceObserver 来连接上游的 source。</li>
<li>用 InnerObserver 来订阅每个变换后的 Observable。</li>
<li>SourceObserver 的下流是一个 SerializedObserver</li>
<li>由 SerializedObserver 将数据发射至最后。</li>
</ol>
<p>其工作的过程是：</p>
<ol>
<li>SourceObserver由 onNext 收到数据，放到队列中。</li>
<li>对队列中的数据进行应用 mapper ，然后用一个 InnerObserver 进行订阅。</li>
<li>InnerObserver 会将数据发射给 SerializedObserver。</li>
<li>SerializedObserver 也在在队列中将数据逐个发射出去。</li>
</ol>
<h1 id="SubscribeOn"><a href="#SubscribeOn" class="headerlink" title="SubscribeOn"></a>SubscribeOn</h1><p>指定 Observable 在哪个 Scheduler 上进行操作。</p>
<h1 id="ObserverOn"><a href="#ObserverOn" class="headerlink" title="ObserverOn"></a>ObserverOn</h1><p>这个操作符的意义，是指定，我们的 Observer 会在哪个 Scheduler 上观察 Observable，也就是说，Observable 将通知发送到哪个 Scheduler。</p>
</div><div class="post-copyright"><blockquote><p>原文作者: Gowa2017 Zhang</p><p>原文链接: <a href="https://gowa2017.github.io/RxJava/关于RxJava操作符flatMap与concatMap的探究.html">https://gowa2017.github.io/RxJava/关于RxJava操作符flatMap与concatMap的探究.html</a></p><p>版权声明: 转载请注明出处(必须保留作者署名及链接)</p></blockquote></div><div class="tags"><a href="/tags/Java/">Java</a><a href="/tags/Android/">Android</a><a href="/tags/RxJava/">RxJava</a></div><div class="post-share"><div class="social-share"><span>分享到:</span></div></div><div class="post-nav"><a href="/Linux-Unix/在Linux为开启SFTP.html" class="pre">在Linux为开启SFTP</a><a href="/RxJava/使用Retrofit-Rxjava来上传下载文件.html" class="next">使用Retrofit-Rxjava来上传下载文件</a></div><div id="comments"><div id="disqus_thread"></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#FlatMap"><span class="toc-text">FlatMap</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#基础"><span class="toc-text">基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#例子"><span class="toc-text">例子</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Assembly"><span class="toc-text">Assembly</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Runtime"><span class="toc-text">Runtime</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ConcatMap"><span class="toc-text">ConcatMap</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SubscribeOn"><span class="toc-text">SubscribeOn</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ObserverOn"><span class="toc-text">ObserverOn</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/Android/Linux-Unix/Hooking-Linux中的共享库函数.html">Hooking-Linux中的共享库函数</a></li><li class="post-list-item"><a class="post-list-link" href="/Android/Riru来注入Zygote进程.html">Riru来注入Zygote进程</a></li><li class="post-list-item"><a class="post-list-link" href="/Android/Android的权限检查过程.html">Android的权限检查过程</a></li><li class="post-list-item"><a class="post-list-link" href="/Android/Android的服务管理.html">Android的服务管理</a></li><li class="post-list-item"><a class="post-list-link" href="/Cpp/使用Clang进行交叉编译.html">使用Clang进行交叉编译</a></li><li class="post-list-item"><a class="post-list-link" href="/Cocos-Creator/Cocos-Creator安卓下的启动流程.html">Cocos-Creator安卓下的启动流程</a></li><li class="post-list-item"><a class="post-list-link" href="/Android/Android中模拟输入的实现.html">Android中模拟输入的实现</a></li><li class="post-list-item"><a class="post-list-link" href="/Lua/Lua中的协程.html">Lua中的协程</a></li><li class="post-list-item"><a class="post-list-link" href="/Android/Auto.js截图后在相册无法立即显示.html">Auto.js截图后在相册无法立即显示</a></li><li class="post-list-item"><a class="post-list-link" href="/Lua/luasocket中的http实现.html">luasocket中的http实现</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">46</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Linux-Unix/">Linux/Unix</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Asm/">Asm</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Cocos-Creator/">Cocos Creator</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Cocos2d-X/">Cocos2d-X</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Cpp/">Cpp</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Device/">Device</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/GTD/">GTD</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Golang/">Golang</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">42</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kindle/">Kindle</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux-Unix/">Linux/Unix</a><span class="category-list-count">45</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Lua/">Lua</a><span class="category-list-count">24</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Misc/">Misc</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/RxJava/">RxJava</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/">TCP/IP</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Vim/">Vim</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Windows/">Windows</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/macOS/">macOS</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">25</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/brew/" style="font-size: 15px;">brew</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Golang/" style="font-size: 15px;">Golang</a> <a href="/tags/Lua/" style="font-size: 15px;">Lua</a> <a href="/tags/Cocos2d-X/" style="font-size: 15px;">Cocos2d-X</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/LVM/" style="font-size: 15px;">LVM</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/RxJava/" style="font-size: 15px;">RxJava</a> <a href="/tags/REST/" style="font-size: 15px;">REST</a> <a href="/tags/Maven/" style="font-size: 15px;">Maven</a> <a href="/tags/VNC/" style="font-size: 15px;">VNC</a> <a href="/tags/Docx/" style="font-size: 15px;">Docx</a> <a href="/tags/SSH/" style="font-size: 15px;">SSH</a> <a href="/tags/X5/" style="font-size: 15px;">X5</a> <a href="/tags/Tbs/" style="font-size: 15px;">Tbs</a> <a href="/tags/Cocos-Creator/" style="font-size: 15px;">Cocos Creator</a> <a href="/tags/TensorFlow/" style="font-size: 15px;">TensorFlow</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/ML/" style="font-size: 15px;">ML</a> <a href="/tags/Oracle/" style="font-size: 15px;">Oracle</a> <a href="/tags/macOS/" style="font-size: 15px;">macOS</a> <a href="/tags/Sqlplus/" style="font-size: 15px;">Sqlplus</a> <a href="/tags/php/" style="font-size: 15px;">php</a> <a href="/tags/apache/" style="font-size: 15px;">apache</a> <a href="/tags/Dagger/" style="font-size: 15px;">Dagger</a> <a href="/tags/PAC/" style="font-size: 15px;">PAC</a> <a href="/tags/NFS/" style="font-size: 15px;">NFS</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/Promise/" style="font-size: 15px;">Promise</a> <a href="/tags/Pomelo/" style="font-size: 15px;">Pomelo</a> <a href="/tags/Retrofit/" style="font-size: 15px;">Retrofit</a> <a href="/tags/Vue/" style="font-size: 15px;">Vue</a> <a href="/tags/Gson/" style="font-size: 15px;">Gson</a> <a href="/tags/GTD/" style="font-size: 15px;">GTD</a> <a href="/tags/Shell/" style="font-size: 15px;">Shell</a> <a href="/tags/Room/" style="font-size: 15px;">Room</a> <a href="/tags/Windows/" style="font-size: 15px;">Windows</a> <a href="/tags/MFC/" style="font-size: 15px;">MFC</a> <a href="/tags/Cpp/" style="font-size: 15px;">Cpp</a> <a href="/tags/Asm/" style="font-size: 15px;">Asm</a> <a href="/tags/RegEx/" style="font-size: 15px;">RegEx</a> <a href="/tags/Kindle/" style="font-size: 15px;">Kindle</a> <a href="/tags/F5/" style="font-size: 15px;">F5</a> <a href="/tags/负载均衡/" style="font-size: 15px;">负载均衡</a> <a href="/tags/Vim/" style="font-size: 15px;">Vim</a> <a href="/tags/OSPF/" style="font-size: 15px;">OSPF</a> <a href="/tags/数据库/" style="font-size: 15px;">数据库</a> <a href="/tags/Oralce/" style="font-size: 15px;">Oralce</a> <a href="/tags/Device/" style="font-size: 15px;">Device</a> <a href="/tags/Raid/" style="font-size: 15px;">Raid</a> <a href="/tags/磁盘阵列/" style="font-size: 15px;">磁盘阵列</a> <a href="/tags/Github/" style="font-size: 15px;">Github</a> <a href="/tags/Markdown/" style="font-size: 15px;">Markdown</a> <a href="/tags/Nginx/" style="font-size: 15px;">Nginx</a> <a href="/tags/Php/" style="font-size: 15px;">Php</a> <a href="/tags/The-Java-Tutorial/" style="font-size: 15px;">The Java Tutorial</a> <a href="/tags/MVP/" style="font-size: 15px;">MVP</a> <a href="/tags/Svn/" style="font-size: 15px;">Svn</a> <a href="/tags/networksetup/" style="font-size: 15px;">networksetup</a> <a href="/tags/Poi/" style="font-size: 15px;">Poi</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/SpringMVC/" style="font-size: 15px;">SpringMVC</a> <a href="/tags/Tomcat/" style="font-size: 15px;">Tomcat</a> <a href="/tags/VIM/" style="font-size: 15px;">VIM</a> <a href="/tags/PIL/" style="font-size: 15px;">PIL</a> <a href="/tags/DHCP/" style="font-size: 15px;">DHCP</a> <a href="/tags/SED/" style="font-size: 15px;">SED</a> <a href="/tags/PPPoE/" style="font-size: 15px;">PPPoE</a> <a href="/tags/launchd/" style="font-size: 15px;">launchd</a> <a href="/tags/JNI/" style="font-size: 15px;">JNI</a> <a href="/tags/Activiti/" style="font-size: 15px;">Activiti</a> <a href="/tags/YouCompleteMe/" style="font-size: 15px;">YouCompleteMe</a> <a href="/tags/YCM/" style="font-size: 15px;">YCM</a> <a href="/tags/Auto-js/" style="font-size: 15px;">Auto.js</a> <a href="/tags/Curl/" style="font-size: 15px;">Curl</a> <a href="/tags/SHELL/" style="font-size: 15px;">SHELL</a> <a href="/tags/运维/" style="font-size: 15px;">运维</a> <a href="/tags/Skynet/" style="font-size: 15px;">Skynet</a> <a href="/tags/So/" style="font-size: 15px;">So</a> <a href="/tags/Apue/" style="font-size: 15px;">Apue</a> <a href="/tags/Rsync/" style="font-size: 15px;">Rsync</a> <a href="/tags/Thread/" style="font-size: 15px;">Thread</a> <a href="/tags/Docx4j/" style="font-size: 15px;">Docx4j</a> <a href="/tags/CentOS/" style="font-size: 15px;">CentOS</a> <a href="/tags/Lsyncd/" style="font-size: 15px;">Lsyncd</a> <a href="/tags/Pandas/" style="font-size: 15px;">Pandas</a> <a href="/tags/KVM/" style="font-size: 15px;">KVM</a> <a href="/tags/Node-js/" style="font-size: 15px;">Node.js</a> <a href="/tags/ffmpeg/" style="font-size: 15px;">ffmpeg</a> <a href="/tags/逆向/" style="font-size: 15px;">逆向</a> <a href="/tags/Aix/" style="font-size: 15px;">Aix</a> <a href="/tags/TCP-IP/" style="font-size: 15px;">TCP/IP</a> <a href="/tags/AWK/" style="font-size: 15px;">AWK</a> <a href="/tags/Iptables/" style="font-size: 15px;">Iptables</a> <a href="/tags/Mysql/" style="font-size: 15px;">Mysql</a> <a href="/tags/Syslog/" style="font-size: 15px;">Syslog</a> <a href="/tags/Tcpdump/" style="font-size: 15px;">Tcpdump</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a></li></ul></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |  <a href="/atom.xml">订阅本站</a> |  <a href="/about/">联系博主</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">Gowa2017 Zhang.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-137245514-1','auto');ga('send','pageview');
</script><script type="text/javascript" src="/js/search.json.js?v=2.0.3"></script><<<<<<< Updated upstream<script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});</script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML" async></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.3" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script><script>var disqus_shortname = 'gowa-1';
var disqus_identifier = 'RxJava/关于RxJava操作符flatMap与concatMap的探究.html';
var disqus_title = '关于RxJava操作符flatMap与concatMap的探究';
var disqus_url = 'https://gowa2017.github.io/RxJava/关于RxJava操作符flatMap与concatMap的探究.html';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//gowa-1.disqus.com/count.js" async></script><script type="text/javascript" src="//gowa-1.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></body></html>